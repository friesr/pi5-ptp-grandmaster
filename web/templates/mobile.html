<!DOCTYPE html>
<html>
<head>
    <title>Mobile Dashboard</title>

    <!-- Mobile Styles -->
    <link rel="stylesheet" href="/static/css/mobile.css">

    <!-- Viewport for proper scaling -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>

    <!-- Sticky Header -->
    <header>Mobile Dashboard</header>

    <!-- System Health -->
    <div class="card">
        <h2><img class="icon" src="/static/icons/health.svg"> System Health</h2>
        <div id="sys-health">Loading...</div>
    </div>

    <!-- GNSS Status -->
    <div class="card">
        <h2><img class="icon" src="/static/icons/gnss.svg"> GNSS Status</h2>
        <div id="gnss-status">Loading...</div>
    </div>

    <!-- PTP Timing -->
    <div class="card">
        <h2><img class="icon" src="/static/icons/ptp.svg"> PTP Timing</h2>
        <div id="ptp-timing">Loading...</div>
    </div>

    <!-- Timing Confidence -->
    <div class="card">
        <h2><img class="icon" src="/static/icons/confidence.svg"> Timing Confidence</h2>
        <div id="timing-confidence">Loading...</div>
    </div>

    <!-- Interference -->
    <div class="card">
        <h2><img class="icon" src="/static/icons/interference.svg"> Interference</h2>
        <div id="interference">Loading...</div>
    </div>

    <!-- SLA Violations -->
    <div class="card">
        <h2><img class="icon" src="/static/icons/sla.svg"> SLA Violations</h2>
        <div id="sla-violations">Loading...</div>
    </div>

    <!-- More Tools (Collapsible) -->
    <div class="card">
        <h2 onclick="toggleTools()" style="cursor:pointer;">
            More Tools â–¼
        </h2>
        <div id="more-tools" style="display:none; margin-top:10px;">
            <button class="nav-button" onclick="location.href='/skyplot-playback'">Skyplot Playback</button>
            <button class="nav-button" onclick="location.href='/multipath-heatmap'">Multipath Heatmap</button>
            <button class="nav-button" onclick="location.href='/prn-health'">PRN Health</button>
            <button class="nav-button" onclick="location.href='/drift'">Drift Analysis</button>
            <button class="nav-button" onclick="location.href='/constellation-timeline'">Constellation Timeline</button>
            <button class="nav-button" onclick="location.href='/digital-twin-replay'">Replay Studio</button>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <div class="bottom-nav">
        <button class="nav-button" onclick="location.href='/'">Home</button>
        <button class="nav-button" onclick="location.href='/gnss-history'">GNSS</button>
        <button class="nav-button" onclick="location.href='/ptp-profile'">PTP</button>
        <button class="nav-button" onclick="location.href='/digital-twin'">Twin</button>
        <button class="nav-button" onclick="location.href='/config'">Config</button>
    </div>

    <!-- Auto-refresh script -->
    <script>
        function fetchData() {
            fetch('/api/system_health')
                .then(r => r.json())
                .then(d => {
                    document.getElementById('sys-health').innerText =
                        `CPU: ${d.cpu}% | RAM: ${d.memory}% | Disk: ${d.disk}%`;
                });

            fetch('/api/gnss_history')
                .then(r => r.json())
                .then(d => {
                    document.getElementById('gnss-status').innerText =
                        `Locked: ${d.locked} | Visible: ${d.visible}`;
                });

            fetch('/api/ptp_profile')
                .then(r => r.json())
                .then(d => {
                    document.getElementById('ptp-timing').innerText =
                        `Offset: ${d.offset} ns | Jitter: ${d.jitter}`;
                });

            fetch('/api/timing_confidence')
                .then(r => r.json())
                .then(d => {
                    document.getElementById('timing-confidence').innerText =
                        `Score: ${d.score}`;
                });

            fetch('/api/interference')
                .then(r => r.json())
                .then(d => {
                    document.getElementById('interference').innerText =
                        `Level: ${d.level}`;
                });

            fetch('/api/sla')
                .then(r => r.json())
                .then(d => {
                    document.getElementById('sla-violations').innerText =
                        `Today: ${d.count}`;
                });
        }

        function toggleTools() {
            const tools = document.getElementById('more-tools');
            tools.style.display = tools.style.display === "none" ? "block" : "none";
        }

        // Refresh every 10 seconds
        setInterval(fetchData, 10000);
        fetchData();
    </script>

</body>
</html>
